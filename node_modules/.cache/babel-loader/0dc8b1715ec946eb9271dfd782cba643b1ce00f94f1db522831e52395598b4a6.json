{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import{useNavigate,useLocation}from'react-router-dom';import'./CheckoutPage.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const CheckoutPage=()=>{const[loading,setLoading]=useState(false);const[error,setError]=useState(null);const navigate=useNavigate();const location=useLocation();const verifyPayment=async sessionId=>{try{const token=localStorage.getItem('authToken');console.log('Verificando pagamento...');const response=await axios.get(\"\".concat(process.env.REACT_APP_BACKEND_URL,\"/payment/verify-payment/\").concat(sessionId),{headers:{'Authorization':\"Bearer \".concat(token)}});console.log('Resposta da verifica√ß√£o:',response.data);if(response.data.status==='success'){navigate('/',{replace:true,state:{refresh:true,paymentSuccess:true}});}}catch(err){console.error('Erro ao verificar pagamento:',err);setError('Erro ao verificar pagamento');}};useEffect(()=>{const params=new URLSearchParams(window.location.search);const sessionId=params.get('session_id');if(sessionId){console.log('Session ID encontrado:',sessionId);verifyPayment(sessionId);}},[location,navigate,verifyPayment]);const handleCheckout=async()=>{setLoading(true);setError(null);try{const token=localStorage.getItem('authToken');const response=await axios.post(\"\".concat(process.env.REACT_APP_BACKEND_URL,\"/payment/create-checkout-session\"),{},{headers:{'Authorization':\"Bearer \".concat(token)}});window.location.href=response.data.checkout_url;}catch(err){console.error('Erro ao iniciar checkout:',err);setError('Erro ao processar pagamento. Tente novamente.');}finally{setLoading(false);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"header\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"/img/logo.jpg\",alt:\"RH Super Sincero Logo\"}),/*#__PURE__*/_jsx(\"h1\",{children:\"CV Sem Frescura\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate('/'),className:\"back-button\",children:\"Voltar\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"checkout-card\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Plano de An\\xE1lise de CV\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"price-box\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"price\",children:\"R$ 29,97\"}),/*#__PURE__*/_jsx(\"span\",{className:\"period\",children:\"por pacote\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"features\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"O que est\\xE1 inclu\\xEDdo:\"}),/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"li\",{children:\"4 an\\xE1lises completas de CV\"}),/*#__PURE__*/_jsx(\"li\",{children:\"2 vagas por an\\xE1lise (total de 8 vagas)\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Recomenda\\xE7\\xF5es personalizadas\"}),/*#__PURE__*/_jsx(\"li\",{children:\"An\\xE1lise com IA avan\\xE7ada\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Suporte por email\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"payment-methods\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Formas de Pagamento:\"}),/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"li\",{children:\"\\uD83D\\uDCB3 Cart\\xE3o de Cr\\xE9dito\"}),/*#__PURE__*/_jsx(\"li\",{children:\"\\uD83D\\uDCC4 Boleto Banc\\xE1rio\"})]})]}),/*#__PURE__*/_jsx(\"button\",{className:\"checkout-button\",onClick:handleCheckout,disabled:loading,children:loading?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{className:\"loading-spinner\"}),\"Processando...\"]}):'Comprar Agora'}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"error-message\",children:error}),/*#__PURE__*/_jsx(\"div\",{className:\"secure-info\",children:/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83D\\uDD12 Pagamento seguro via Stripe\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"checkout-footer\",children:/*#__PURE__*/_jsx(\"p\",{children:\"Ao realizar a compra, voc\\xEA concorda com nossos Termos de Servi\\xE7o\"})})]})]});};export default CheckoutPage;","map":{"version":3,"names":["React","useState","useEffect","axios","useNavigate","useLocation","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","CheckoutPage","loading","setLoading","error","setError","navigate","location","verifyPayment","sessionId","token","localStorage","getItem","console","log","response","get","concat","process","env","REACT_APP_BACKEND_URL","headers","data","status","replace","state","refresh","paymentSuccess","err","params","URLSearchParams","window","search","handleCheckout","post","href","checkout_url","className","children","src","alt","onClick","disabled"],"sources":["C:/Users/Rafael/Repository/frontend/src/components/Checkout/CheckoutPage.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport { useNavigate, useLocation } from 'react-router-dom';\r\nimport './CheckoutPage.css';\r\n\r\nconst CheckoutPage = () => {\r\n    const [loading, setLoading] = useState(false);\r\n    const [error, setError] = useState(null);\r\n    const navigate = useNavigate();\r\n    const location = useLocation();\r\n\r\n    const verifyPayment = async (sessionId) => {\r\n        try {\r\n            const token = localStorage.getItem('authToken');\r\n            console.log('Verificando pagamento...');\r\n            const response = await axios.get(\r\n                `${process.env.REACT_APP_BACKEND_URL}/payment/verify-payment/${sessionId}`,\r\n                {\r\n                    headers: {\r\n                        'Authorization': `Bearer ${token}`\r\n                    }\r\n                }\r\n            );\r\n            \r\n            console.log('Resposta da verifica√ß√£o:', response.data);\r\n            \r\n            if (response.data.status === 'success') {\r\n                navigate('/', { \r\n                    replace: true, \r\n                    state: { \r\n                        refresh: true,\r\n                        paymentSuccess: true \r\n                    }\r\n                });\r\n            }\r\n        } catch (err) {\r\n            console.error('Erro ao verificar pagamento:', err);\r\n            setError('Erro ao verificar pagamento');\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        const params = new URLSearchParams(window.location.search);\r\n        const sessionId = params.get('session_id');\r\n        \r\n        if (sessionId) {\r\n            console.log('Session ID encontrado:', sessionId);\r\n            verifyPayment(sessionId);\r\n        }\r\n    }, [location, navigate, verifyPayment]);\r\n\r\n    const handleCheckout = async () => {\r\n        setLoading(true);\r\n        setError(null);\r\n\r\n        try {\r\n            const token = localStorage.getItem('authToken');\r\n            const response = await axios.post(\r\n                `${process.env.REACT_APP_BACKEND_URL}/payment/create-checkout-session`,\r\n                {},\r\n                {\r\n                    headers: {\r\n                        'Authorization': `Bearer ${token}`\r\n                    }\r\n                }\r\n            );\r\n\r\n            window.location.href = response.data.checkout_url;\r\n        } catch (err) {\r\n            console.error('Erro ao iniciar checkout:', err);\r\n            setError('Erro ao processar pagamento. Tente novamente.');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"container\">\r\n            <div className=\"header\">\r\n                <img src=\"/img/logo.jpg\" alt=\"RH Super Sincero Logo\" />\r\n                <h1>CV Sem Frescura</h1>\r\n                <button onClick={() => navigate('/')} className=\"back-button\">\r\n                    Voltar\r\n                </button>\r\n            </div>\r\n\r\n            <div className=\"checkout-card\">\r\n                <h2>Plano de An√°lise de CV</h2>\r\n                <div className=\"price-box\">\r\n                    <span className=\"price\">R$ 29,97</span>\r\n                    <span className=\"period\">por pacote</span>\r\n                </div>\r\n\r\n                <div className=\"features\">\r\n                    <h3>O que est√° inclu√≠do:</h3>\r\n                    <ul>\r\n                        <li>4 an√°lises completas de CV</li>\r\n                        <li>2 vagas por an√°lise (total de 8 vagas)</li>\r\n                        <li>Recomenda√ß√µes personalizadas</li>\r\n                        <li>An√°lise com IA avan√ßada</li>\r\n                        <li>Suporte por email</li>\r\n                    </ul>\r\n                </div>\r\n\r\n                <div className=\"payment-methods\">\r\n                    <h3>Formas de Pagamento:</h3>\r\n                    <ul>\r\n                        <li>üí≥ Cart√£o de Cr√©dito</li>\r\n                        <li>üìÑ Boleto Banc√°rio</li>\r\n                    </ul>\r\n                </div>\r\n\r\n                <button \r\n                    className=\"checkout-button\"\r\n                    onClick={handleCheckout}\r\n                    disabled={loading}\r\n                >\r\n                    {loading ? (\r\n                        <>\r\n                            <span className=\"loading-spinner\"></span>\r\n                            Processando...\r\n                        </>\r\n                    ) : (\r\n                        'Comprar Agora'\r\n                    )}\r\n                </button>\r\n\r\n                {error && <div className=\"error-message\">{error}</div>}\r\n\r\n                <div className=\"secure-info\">\r\n                    <span>üîí Pagamento seguro via Stripe</span>\r\n                </div>\r\n\r\n                <div className=\"checkout-footer\">\r\n                    <p>Ao realizar a compra, voc√™ concorda com nossos Termos de Servi√ßo</p>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default CheckoutPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}